<?xml version="1.0" encoding="utf-8"?>
<!--
  For more information on how to configure your Node.js application, please visit
  http://go.microsoft.com/fwlink/?LinkId=290972
  -->


<configuration>
	<appSettings>
		<!--
    <add key="StorageAccountName" value="" />
    <add key="StorageAccountKey" value="" />
    <add key="ServiceBusNamespace" value="" />
    <add key="ServiceBusIssuerName" value="" />
    <add key="ServiceBusIssuerSecretKey" value="" />
    -->
	</appSettings>
	<system.webServer>
		<!-- mimeMap enables IIS to serve particular file types as specified by fileExtension. -->
		&amp;lt;webSocket enabled=&amp;quot;false&amp;quot; /&amp;gt;
		<staticContent>
			<mimeMap fileExtension=".svg" mimeType="image/svg+xml" />
		</staticContent>

		<modules runAllManagedModulesForAllRequests="false" />

		<!-- Web.Debug.config adds attributes to this to enable remote debugging when publishing in Debug configuration. -->
		<iisnode watchedFiles="web.config;*.js;routes\*.js;views\*.jade"
			loggingEnabled="true"
			devErrorsEnabled="true"
			nodeProcessCommandLine="node.exe --debug"/>

		<!-- Remote debugging (Azure Website with git deploy): Comment out iisnode above, and uncomment iisnode below. -->
		<!--<iisnode watchedFiles="web.config;*.js;routes\*.js;views\*.jade"
      loggingEnabled="true"
      devErrorsEnabled="true"
      nodeProcessCommandLine="node.exe &#45;&#45;debug"/>-->

		<!-- indicates that the server.js file is a Node.js application 
    to be handled by the iisnode module -->
		<handlers>
			<add name="iisnode" path="app.js" verb="*" modules="iisnode" />

			<!-- Remote debugging (Azure Website with git deploy): Uncomment NtvsDebugProxy handler below.
      Additionally copy Microsoft.NodejsTools.WebRole to 'bin' from the Remote Debug Proxy folder.-->
			<!--<add name="NtvsDebugProxy" path="ntvs-debug-proxy/3bce8a97-1845-452d-9dad-532d1165b67e" verb="*" resourceType="Unspecified"
        type="Microsoft.NodejsTools.Debugger.WebSocketProxy, Microsoft.NodejsTools.WebRole"/>-->
			<add name="NtvsDebugProxy" path="ntvs-debug-proxy/3bce8a97-1845-452d-9dad-532d1165b67e" verb="*" resourceType="Unspecified"
				type="Microsoft.NodejsTools.Debugger.WebSocketProxy, Microsoft.NodejsTools.WebRole"/>
		</handlers>
		<rewrite>
			<rules>
				<clear />
				<rule name="NtvsDebugProxy" enabled="true" stopProcessing="true">
					<match url="^ntvs-debug-proxy/.*"/>
				</rule>
				<!-- Remote debugging (Azure Website with git deploy): Uncomment the NtvsDebugProxy rule below. -->
				<!--<rule name="NtvsDebugProxy" enabled="true" stopProcessing="true">
          <match url="^ntvs-debug-proxy/.*"/>
        </rule>-->
				<rule name="app" enabled="true" patternSyntax="ECMAScript" stopProcessing="true">
					<match url="iisnode.+" negate="true" />
					<conditions logicalGrouping="MatchAll" trackAllCaptures="false" />
					<action type="Rewrite" url="app.js" />
				</rule>
			</rules>
		</rewrite>
	</system.webServer>
	<system.web>
		<httpRuntime targetFramework="4.5"/>
		<customErrors mode="Off"/>
	</system.web>

</configuration>